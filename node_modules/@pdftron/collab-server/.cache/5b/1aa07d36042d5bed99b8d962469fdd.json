{"id":"b1X9","dependencies":[{"name":"/Users/loganbittner/Documents/apollo-collab/packages/collab-server/tsconfig.json","includedInParent":true,"mtime":1601908799394},{"name":"/Users/loganbittner/Documents/apollo-collab/packages/collab-server/package.json","includedInParent":true,"mtime":1607970749445}],"generated":{"js":"\"use strict\";var t,o,e,s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var o,e=1,s=arguments.length;e<s;e++)for(var n in o=arguments[e])Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);return t}).apply(this,arguments)};Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.setPermissions=exports.Actions=exports.Roles=exports.Entities=void 0,exports.Entities={DOCUMENT:\"document\",ANNOTATION:\"annotation\"},exports.Roles={DOCUMENT_AUTHOR:\"document_author\",DOCUMENT_MEMBER:\"document_member\",ANNOTATION_AUTHOR:\"annotation_author\",ANY:\"any\"},exports.Actions={READ:\"read\",ADD:\"add\",EDIT:\"edit\",DELETE:\"delete\",INVITE:\"invite\"};var n=((t={})[exports.Entities.DOCUMENT]=((o={})[exports.Actions.ADD]=[exports.Roles.ANY],o[exports.Actions.EDIT]=[exports.Roles.DOCUMENT_AUTHOR],o[exports.Actions.READ]=[exports.Roles.DOCUMENT_MEMBER],o[exports.Actions.DELETE]=[exports.Roles.DOCUMENT_AUTHOR],o[exports.Actions.INVITE]=[exports.Roles.DOCUMENT_AUTHOR],o),t[exports.Entities.ANNOTATION]=((e={})[exports.Actions.ADD]=[exports.Roles.DOCUMENT_MEMBER],e[exports.Actions.EDIT]=[exports.Roles.ANNOTATION_AUTHOR],e[exports.Actions.READ]=[exports.Roles.DOCUMENT_MEMBER],e[exports.Actions.DELETE]=[exports.Roles.ANNOTATION_AUTHOR],e),t);exports.setPermissions=function(t){void 0===t&&(t={});var o=t.document,e=t.annotation,r=s({},n);return o&&(\"string\"==typeof o?Object.keys(n.document).forEach(function(t){return r.document[t]=[].concat(o)}):Object.keys(o).forEach(function(t){return r.document[t]=[].concat(o[t])})),e&&(\"string\"==typeof e?Object.keys(n.annotation).forEach(function(t){r.annotation[t]=[].concat(e)}):Object.keys(e).forEach(function(t){return r.annotation[t]=[].concat(e[t])})),r};var r={Roles:exports.Roles,Actions:exports.Actions,Entities:exports.Entities};exports.default=r;"},"sourceMaps":{"js":{"mappings":[{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":0}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":13}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":17}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":19}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":21}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":23}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":25}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":31}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":36}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":46}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":57}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":64}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":66}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":73}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":81}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":90}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":93}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":97}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":101}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":103}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":105}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":107}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":109}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":119}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":126}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":128}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":130}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":134}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":138}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":142}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":147}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":149}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":159}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":162}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":169}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":179}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":194}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":199}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":201}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":206}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":208}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":211}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":213}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":217}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":224}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":228}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":234}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":239}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":251}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":258}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":273}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":281}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":294}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":295}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":302}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":306}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":314}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":329}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":337}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":345}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":353}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":359}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":367}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":381}},{"source":"util/permission.ts","name":null,"original":{"line":2,"column":13},"generated":{"line":1,"column":383}},{"source":"util/permission.ts","name":null,"original":{"line":2,"column":13},"generated":{"line":1,"column":391}},{"source":"util/permission.ts","name":null,"original":{"line":2,"column":24},"generated":{"line":1,"column":400}},{"source":"util/permission.ts","name":null,"original":{"line":3,"column":2},"generated":{"line":1,"column":401}},{"source":"util/permission.ts","name":null,"original":{"line":3,"column":12},"generated":{"line":1,"column":410}},{"source":"util/permission.ts","name":null,"original":{"line":4,"column":2},"generated":{"line":1,"column":421}},{"source":"util/permission.ts","name":null,"original":{"line":4,"column":15},"generated":{"line":1,"column":432}},{"source":"util/permission.ts","name":null,"original":{"line":9,"column":13},"generated":{"line":1,"column":446}},{"source":"util/permission.ts","name":null,"original":{"line":9,"column":13},"generated":{"line":1,"column":454}},{"source":"util/permission.ts","name":null,"original":{"line":9,"column":21},"generated":{"line":1,"column":460}},{"source":"util/permission.ts","name":null,"original":{"line":10,"column":2},"generated":{"line":1,"column":461}},{"source":"util/permission.ts","name":null,"original":{"line":10,"column":19},"generated":{"line":1,"column":477}},{"source":"util/permission.ts","name":null,"original":{"line":11,"column":2},"generated":{"line":1,"column":495}},{"source":"util/permission.ts","name":null,"original":{"line":11,"column":19},"generated":{"line":1,"column":511}},{"source":"util/permission.ts","name":null,"original":{"line":12,"column":2},"generated":{"line":1,"column":529}},{"source":"util/permission.ts","name":null,"original":{"line":12,"column":21},"generated":{"line":1,"column":547}},{"source":"util/permission.ts","name":null,"original":{"line":13,"column":2},"generated":{"line":1,"column":567}},{"source":"util/permission.ts","name":null,"original":{"line":13,"column":7},"generated":{"line":1,"column":571}},{"source":"util/permission.ts","name":null,"original":{"line":16,"column":13},"generated":{"line":1,"column":578}},{"source":"util/permission.ts","name":null,"original":{"line":16,"column":13},"generated":{"line":1,"column":586}},{"source":"util/permission.ts","name":null,"original":{"line":16,"column":23},"generated":{"line":1,"column":594}},{"source":"util/permission.ts","name":null,"original":{"line":17,"column":2},"generated":{"line":1,"column":595}},{"source":"util/permission.ts","name":null,"original":{"line":17,"column":8},"generated":{"line":1,"column":600}},{"source":"util/permission.ts","name":null,"original":{"line":18,"column":2},"generated":{"line":1,"column":607}},{"source":"util/permission.ts","name":null,"original":{"line":18,"column":7},"generated":{"line":1,"column":611}},{"source":"util/permission.ts","name":null,"original":{"line":19,"column":2},"generated":{"line":1,"column":617}},{"source":"util/permission.ts","name":null,"original":{"line":19,"column":8},"generated":{"line":1,"column":622}},{"source":"util/permission.ts","name":null,"original":{"line":20,"column":2},"generated":{"line":1,"column":629}},{"source":"util/permission.ts","name":null,"original":{"line":20,"column":10},"generated":{"line":1,"column":636}},{"source":"util/permission.ts","name":null,"original":{"line":21,"column":2},"generated":{"line":1,"column":645}},{"source":"util/permission.ts","name":null,"original":{"line":21,"column":10},"generated":{"line":1,"column":652}},{"source":"util/permission.ts","name":null,"original":{"line":51,"column":0},"generated":{"line":1,"column":662}},{"source":"util/permission.ts","name":null,"original":{"line":51,"column":6},"generated":{"line":1,"column":666}},{"source":"util/permission.ts","name":null,"original":{"line":51,"column":20},"generated":{"line":1,"column":670}},{"source":"util/permission.ts","name":null,"original":{"line":51,"column":20},"generated":{"line":1,"column":672}},{"source":"util/permission.ts","name":null,"original":{"line":52,"column":3},"generated":{"line":1,"column":676}},{"source":"util/permission.ts","name":null,"original":{"line":52,"column":3},"generated":{"line":1,"column":684}},{"source":"util/permission.ts","name":null,"original":{"line":52,"column":12},"generated":{"line":1,"column":693}},{"source":"util/permission.ts","name":null,"original":{"line":52,"column":20},"generated":{"line":1,"column":705}},{"source":"util/permission.ts","name":null,"original":{"line":52,"column":20},"generated":{"line":1,"column":707}},{"source":"util/permission.ts","name":null,"original":{"line":53,"column":5},"generated":{"line":1,"column":711}},{"source":"util/permission.ts","name":null,"original":{"line":53,"column":5},"generated":{"line":1,"column":719}},{"source":"util/permission.ts","name":null,"original":{"line":53,"column":13},"generated":{"line":1,"column":727}},{"source":"util/permission.ts","name":null,"original":{"line":53,"column":19},"generated":{"line":1,"column":732}},{"source":"util/permission.ts","name":null,"original":{"line":53,"column":20},"generated":{"line":1,"column":733}},{"source":"util/permission.ts","name":null,"original":{"line":53,"column":20},"generated":{"line":1,"column":741}},{"source":"util/permission.ts","name":null,"original":{"line":53,"column":26},"generated":{"line":1,"column":747}},{"source":"util/permission.ts","name":null,"original":{"line":54,"column":4},"generated":{"line":1,"column":752}},{"source":"util/permission.ts","name":null,"original":{"line":54,"column":5},"generated":{"line":1,"column":754}},{"source":"util/permission.ts","name":null,"original":{"line":54,"column":5},"generated":{"line":1,"column":762}},{"source":"util/permission.ts","name":null,"original":{"line":54,"column":13},"generated":{"line":1,"column":770}},{"source":"util/permission.ts","name":null,"original":{"line":54,"column":20},"generated":{"line":1,"column":776}},{"source":"util/permission.ts","name":null,"original":{"line":54,"column":21},"generated":{"line":1,"column":777}},{"source":"util/permission.ts","name":null,"original":{"line":54,"column":21},"generated":{"line":1,"column":785}},{"source":"util/permission.ts","name":null,"original":{"line":54,"column":27},"generated":{"line":1,"column":791}},{"source":"util/permission.ts","name":null,"original":{"line":55,"column":4},"generated":{"line":1,"column":808}},{"source":"util/permission.ts","name":null,"original":{"line":55,"column":5},"generated":{"line":1,"column":810}},{"source":"util/permission.ts","name":null,"original":{"line":55,"column":5},"generated":{"line":1,"column":818}},{"source":"util/permission.ts","name":null,"original":{"line":55,"column":13},"generated":{"line":1,"column":826}},{"source":"util/permission.ts","name":null,"original":{"line":55,"column":20},"generated":{"line":1,"column":832}},{"source":"util/permission.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":1,"column":833}},{"source":"util/permission.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":1,"column":841}},{"source":"util/permission.ts","name":null,"original":{"line":55,"column":27},"generated":{"line":1,"column":847}},{"source":"util/permission.ts","name":null,"original":{"line":56,"column":4},"generated":{"line":1,"column":864}},{"source":"util/permission.ts","name":null,"original":{"line":56,"column":5},"generated":{"line":1,"column":866}},{"source":"util/permission.ts","name":null,"original":{"line":56,"column":5},"generated":{"line":1,"column":874}},{"source":"util/permission.ts","name":null,"original":{"line":56,"column":13},"generated":{"line":1,"column":882}},{"source":"util/permission.ts","name":null,"original":{"line":56,"column":22},"generated":{"line":1,"column":890}},{"source":"util/permission.ts","name":null,"original":{"line":56,"column":23},"generated":{"line":1,"column":891}},{"source":"util/permission.ts","name":null,"original":{"line":56,"column":23},"generated":{"line":1,"column":899}},{"source":"util/permission.ts","name":null,"original":{"line":56,"column":29},"generated":{"line":1,"column":905}},{"source":"util/permission.ts","name":null,"original":{"line":57,"column":4},"generated":{"line":1,"column":922}},{"source":"util/permission.ts","name":null,"original":{"line":57,"column":5},"generated":{"line":1,"column":924}},{"source":"util/permission.ts","name":null,"original":{"line":57,"column":5},"generated":{"line":1,"column":932}},{"source":"util/permission.ts","name":null,"original":{"line":57,"column":13},"generated":{"line":1,"column":940}},{"source":"util/permission.ts","name":null,"original":{"line":57,"column":22},"generated":{"line":1,"column":948}},{"source":"util/permission.ts","name":null,"original":{"line":57,"column":23},"generated":{"line":1,"column":949}},{"source":"util/permission.ts","name":null,"original":{"line":57,"column":23},"generated":{"line":1,"column":957}},{"source":"util/permission.ts","name":null,"original":{"line":57,"column":29},"generated":{"line":1,"column":963}},{"source":"util/permission.ts","name":null,"original":{"line":52,"column":2},"generated":{"line":1,"column":980}},{"source":"util/permission.ts","name":null,"original":{"line":59,"column":2},"generated":{"line":1,"column":983}},{"source":"util/permission.ts","name":null,"original":{"line":59,"column":3},"generated":{"line":1,"column":985}},{"source":"util/permission.ts","name":null,"original":{"line":59,"column":3},"generated":{"line":1,"column":993}},{"source":"util/permission.ts","name":null,"original":{"line":59,"column":12},"generated":{"line":1,"column":1002}},{"source":"util/permission.ts","name":null,"original":{"line":59,"column":22},"generated":{"line":1,"column":1016}},{"source":"util/permission.ts","name":null,"original":{"line":59,"column":22},"generated":{"line":1,"column":1018}},{"source":"util/permission.ts","name":null,"original":{"line":60,"column":5},"generated":{"line":1,"column":1022}},{"source":"util/permission.ts","name":null,"original":{"line":60,"column":5},"generated":{"line":1,"column":1030}},{"source":"util/permission.ts","name":null,"original":{"line":60,"column":13},"generated":{"line":1,"column":1038}},{"source":"util/permission.ts","name":null,"original":{"line":60,"column":19},"generated":{"line":1,"column":1043}},{"source":"util/permission.ts","name":null,"original":{"line":60,"column":20},"generated":{"line":1,"column":1044}},{"source":"util/permission.ts","name":null,"original":{"line":60,"column":20},"generated":{"line":1,"column":1052}},{"source":"util/permission.ts","name":null,"original":{"line":60,"column":26},"generated":{"line":1,"column":1058}},{"source":"util/permission.ts","name":null,"original":{"line":61,"column":4},"generated":{"line":1,"column":1075}},{"source":"util/permission.ts","name":null,"original":{"line":61,"column":5},"generated":{"line":1,"column":1077}},{"source":"util/permission.ts","name":null,"original":{"line":61,"column":5},"generated":{"line":1,"column":1085}},{"source":"util/permission.ts","name":null,"original":{"line":61,"column":13},"generated":{"line":1,"column":1093}},{"source":"util/permission.ts","name":null,"original":{"line":61,"column":20},"generated":{"line":1,"column":1099}},{"source":"util/permission.ts","name":null,"original":{"line":61,"column":21},"generated":{"line":1,"column":1100}},{"source":"util/permission.ts","name":null,"original":{"line":61,"column":21},"generated":{"line":1,"column":1108}},{"source":"util/permission.ts","name":null,"original":{"line":61,"column":27},"generated":{"line":1,"column":1114}},{"source":"util/permission.ts","name":null,"original":{"line":62,"column":4},"generated":{"line":1,"column":1133}},{"source":"util/permission.ts","name":null,"original":{"line":62,"column":5},"generated":{"line":1,"column":1135}},{"source":"util/permission.ts","name":null,"original":{"line":62,"column":5},"generated":{"line":1,"column":1143}},{"source":"util/permission.ts","name":null,"original":{"line":62,"column":13},"generated":{"line":1,"column":1151}},{"source":"util/permission.ts","name":null,"original":{"line":62,"column":20},"generated":{"line":1,"column":1157}},{"source":"util/permission.ts","name":null,"original":{"line":62,"column":21},"generated":{"line":1,"column":1158}},{"source":"util/permission.ts","name":null,"original":{"line":62,"column":21},"generated":{"line":1,"column":1166}},{"source":"util/permission.ts","name":null,"original":{"line":62,"column":27},"generated":{"line":1,"column":1172}},{"source":"util/permission.ts","name":null,"original":{"line":63,"column":4},"generated":{"line":1,"column":1189}},{"source":"util/permission.ts","name":null,"original":{"line":63,"column":5},"generated":{"line":1,"column":1191}},{"source":"util/permission.ts","name":null,"original":{"line":63,"column":5},"generated":{"line":1,"column":1199}},{"source":"util/permission.ts","name":null,"original":{"line":63,"column":13},"generated":{"line":1,"column":1207}},{"source":"util/permission.ts","name":null,"original":{"line":63,"column":22},"generated":{"line":1,"column":1215}},{"source":"util/permission.ts","name":null,"original":{"line":63,"column":23},"generated":{"line":1,"column":1216}},{"source":"util/permission.ts","name":null,"original":{"line":63,"column":23},"generated":{"line":1,"column":1224}},{"source":"util/permission.ts","name":null,"original":{"line":63,"column":29},"generated":{"line":1,"column":1230}},{"source":"util/permission.ts","name":null,"original":{"line":59,"column":2},"generated":{"line":1,"column":1249}},{"source":"util/permission.ts","name":null,"original":{"line":51,"column":20},"generated":{"line":1,"column":1252}},{"source":"util/permission.ts","name":null,"original":{"line":67,"column":13},"generated":{"line":1,"column":1255}},{"source":"util/permission.ts","name":null,"original":{"line":67,"column":13},"generated":{"line":1,"column":1263}},{"source":"util/permission.ts","name":null,"original":{"line":67,"column":30},"generated":{"line":1,"column":1278}},{"source":"util/permission.ts","name":null,"original":{"line":67,"column":31},"generated":{"line":1,"column":1287}},{"source":"util/permission.ts","name":null,"original":{"line":67,"column":31},"generated":{"line":1,"column":1295}},{"source":"util/permission.ts","name":null,"original":{"line":67,"column":31},"generated":{"line":1,"column":1299}},{"source":"util/permission.ts","name":null,"original":{"line":67,"column":31},"generated":{"line":1,"column":1303}},{"source":"util/permission.ts","name":null,"original":{"line":67,"column":31},"generated":{"line":1,"column":1305}},{"source":"util/permission.ts","name":null,"original":{"line":68,"column":8},"generated":{"line":1,"column":1309}},{"source":"util/permission.ts","name":null,"original":{"line":68,"column":8},"generated":{"line":1,"column":1313}},{"source":"util/permission.ts","name":null,"original":{"line":68,"column":24},"generated":{"line":1,"column":1315}},{"source":"util/permission.ts","name":null,"original":{"line":68,"column":32},"generated":{"line":1,"column":1317}},{"source":"util/permission.ts","name":null,"original":{"line":69,"column":8},"generated":{"line":1,"column":1326}},{"source":"util/permission.ts","name":null,"original":{"line":69,"column":26},"generated":{"line":1,"column":1328}},{"source":"util/permission.ts","name":null,"original":{"line":69,"column":34},"generated":{"line":1,"column":1330}},{"source":"util/permission.ts","name":null,"original":{"line":70,"column":8},"generated":{"line":1,"column":1341}},{"source":"util/permission.ts","name":null,"original":{"line":70,"column":22},"generated":{"line":1,"column":1343}},{"source":"util/permission.ts","name":null,"original":{"line":70,"column":22},"generated":{"line":1,"column":1345}},{"source":"util/permission.ts","name":null,"original":{"line":70,"column":29},"generated":{"line":1,"column":1348}},{"source":"util/permission.ts","name":null,"original":{"line":90,"column":9},"generated":{"line":1,"column":1351}},{"source":"util/permission.ts","name":null,"original":{"line":72,"column":5},"generated":{"line":1,"column":1358}},{"source":"util/permission.ts","name":null,"original":{"line":73,"column":32},"generated":{"line":1,"column":1362}},{"source":"util/permission.ts","name":null,"original":{"line":73,"column":14},"generated":{"line":1,"column":1379}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":6},"generated":{"line":1,"column":1381}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":13},"generated":{"line":1,"column":1388}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":18},"generated":{"line":1,"column":1393}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":33},"generated":{"line":1,"column":1395}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":43},"generated":{"line":1,"column":1405}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":51},"generated":{"line":1,"column":1413}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":51},"generated":{"line":1,"column":1422}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":61},"generated":{"line":1,"column":1425}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":61},"generated":{"line":1,"column":1432}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":76},"generated":{"line":1,"column":1434}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":85},"generated":{"line":1,"column":1443}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":95},"generated":{"line":1,"column":1446}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":98},"generated":{"line":1,"column":1449}},{"source":"util/permission.ts","name":null,"original":{"line":75,"column":105},"generated":{"line":1,"column":1456}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":6},"generated":{"line":1,"column":1461}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":13},"generated":{"line":1,"column":1468}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":18},"generated":{"line":1,"column":1473}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":33},"generated":{"line":1,"column":1476}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":41},"generated":{"line":1,"column":1484}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":41},"generated":{"line":1,"column":1493}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":51},"generated":{"line":1,"column":1496}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":51},"generated":{"line":1,"column":1503}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":66},"generated":{"line":1,"column":1505}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":75},"generated":{"line":1,"column":1514}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":85},"generated":{"line":1,"column":1517}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":88},"generated":{"line":1,"column":1520}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":95},"generated":{"line":1,"column":1527}},{"source":"util/permission.ts","name":null,"original":{"line":77,"column":109},"generated":{"line":1,"column":1529}},{"source":"util/permission.ts","name":null,"original":{"line":80,"column":5},"generated":{"line":1,"column":1536}},{"source":"util/permission.ts","name":null,"original":{"line":81,"column":34},"generated":{"line":1,"column":1540}},{"source":"util/permission.ts","name":null,"original":{"line":81,"column":14},"generated":{"line":1,"column":1557}},{"source":"util/permission.ts","name":null,"original":{"line":83,"column":6},"generated":{"line":1,"column":1559}},{"source":"util/permission.ts","name":null,"original":{"line":83,"column":13},"generated":{"line":1,"column":1566}},{"source":"util/permission.ts","name":null,"original":{"line":83,"column":18},"generated":{"line":1,"column":1571}},{"source":"util/permission.ts","name":null,"original":{"line":83,"column":33},"generated":{"line":1,"column":1573}},{"source":"util/permission.ts","name":null,"original":{"line":83,"column":45},"generated":{"line":1,"column":1585}},{"source":"util/permission.ts","name":null,"original":{"line":83,"column":53},"generated":{"line":1,"column":1593}},{"source":"util/permission.ts","name":null,"original":{"line":83,"column":53},"generated":{"line":1,"column":1602}},{"source":"util/permission.ts","name":null,"original":{"line":84,"column":8},"generated":{"line":1,"column":1605}},{"source":"util/permission.ts","name":null,"original":{"line":84,"column":23},"generated":{"line":1,"column":1607}},{"source":"util/permission.ts","name":null,"original":{"line":84,"column":34},"generated":{"line":1,"column":1618}},{"source":"util/permission.ts","name":null,"original":{"line":84,"column":44},"generated":{"line":1,"column":1621}},{"source":"util/permission.ts","name":null,"original":{"line":84,"column":47},"generated":{"line":1,"column":1624}},{"source":"util/permission.ts","name":null,"original":{"line":84,"column":54},"generated":{"line":1,"column":1631}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":6},"generated":{"line":1,"column":1636}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":13},"generated":{"line":1,"column":1643}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":18},"generated":{"line":1,"column":1648}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":35},"generated":{"line":1,"column":1651}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":43},"generated":{"line":1,"column":1659}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":43},"generated":{"line":1,"column":1668}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":53},"generated":{"line":1,"column":1671}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":53},"generated":{"line":1,"column":1678}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":68},"generated":{"line":1,"column":1680}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":79},"generated":{"line":1,"column":1691}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":89},"generated":{"line":1,"column":1694}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":92},"generated":{"line":1,"column":1697}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":99},"generated":{"line":1,"column":1704}},{"source":"util/permission.ts","name":null,"original":{"line":87,"column":115},"generated":{"line":1,"column":1706}},{"source":"util/permission.ts","name":null,"original":{"line":90,"column":9},"generated":{"line":1,"column":1713}},{"source":"util/permission.ts","name":null,"original":{"line":93,"column":0},"generated":{"line":1,"column":1716}},{"source":"util/permission.ts","name":null,"original":{"line":93,"column":6},"generated":{"line":1,"column":1720}},{"source":"util/permission.ts","name":null,"original":{"line":93,"column":28},"generated":{"line":1,"column":1722}},{"source":"util/permission.ts","name":null,"original":{"line":94,"column":2},"generated":{"line":1,"column":1723}},{"source":"util/permission.ts","name":null,"original":{"line":94,"column":7},"generated":{"line":1,"column":1729}},{"source":"util/permission.ts","name":null,"original":{"line":94,"column":7},"generated":{"line":1,"column":1737}},{"source":"util/permission.ts","name":null,"original":{"line":95,"column":2},"generated":{"line":1,"column":1743}},{"source":"util/permission.ts","name":null,"original":{"line":95,"column":9},"generated":{"line":1,"column":1751}},{"source":"util/permission.ts","name":null,"original":{"line":95,"column":9},"generated":{"line":1,"column":1759}},{"source":"util/permission.ts","name":null,"original":{"line":96,"column":2},"generated":{"line":1,"column":1767}},{"source":"util/permission.ts","name":null,"original":{"line":96,"column":10},"generated":{"line":1,"column":1776}},{"source":"util/permission.ts","name":null,"original":{"line":96,"column":10},"generated":{"line":1,"column":1784}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":1794}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":0},"generated":{"line":1,"column":1802}},{"source":"util/permission.ts","name":null,"original":{"line":99,"column":15},"generated":{"line":1,"column":1810}}],"sources":{"util/permission.ts":"import type { ApolloUser } from './../resolvers';\nexport const Entities = {\n  DOCUMENT: 'document',\n  ANNOTATION : 'annotation'\n} as const;\n\nexport type Entities = typeof Entities[keyof typeof Entities];\n\nexport const Roles = {\n  DOCUMENT_AUTHOR: 'document_author',\n  DOCUMENT_MEMBER: 'document_member',\n  ANNOTATION_AUTHOR: 'annotation_author',\n  ANY: 'any'\n} as const;\n\nexport const Actions = {\n  READ: 'read',\n  ADD: 'add',\n  EDIT: 'edit',\n  DELETE: 'delete',\n  INVITE: 'invite'\n} as const;\n\nexport type Roles = typeof Roles[keyof typeof Roles];\nexport type Actions = typeof Actions[keyof typeof Actions];\n\nexport type AuthMethod = Roles | AuthorizeFunction;\n\n// one role for all actions, if role is passed for each entity permission setting\nexport type UserPermissionSetting = {\n  document?: Roles | EntityPermissions;\n  annotation?: Roles | EntityPermissions;\n}\n\nexport type PermissionSetting = {\n  document: EntityPermissions,\n  annotation: Omit<EntityPermissions, 'invite'>\n}\n\n//permission setting passed in by users\nexport type EntityPermissions = { \n  read?: AuthMethod | Array<AuthMethod>;\n  invite?: AuthMethod | Array<AuthMethod>;\n  edit?: AuthMethod | Array<AuthMethod>;\n  delete?: AuthMethod | Array<AuthMethod>;\n  add?: AuthMethod | Array<AuthMethod>;\n}\n\nexport type AuthorizeFunction = (entity: any, user: Pick<ApolloUser, \"id\" | \"createdAt\" | \"email\" | \"type\">) => Promise<boolean>;\n\nconst defaultSetting: PermissionSetting = {\n  [Entities.DOCUMENT]: {\n    [Actions.ADD]: [Roles.ANY],\n    [Actions.EDIT]: [Roles.DOCUMENT_AUTHOR],\n    [Actions.READ]: [Roles.DOCUMENT_MEMBER],\n    [Actions.DELETE]: [Roles.DOCUMENT_AUTHOR],\n    [Actions.INVITE]: [Roles.DOCUMENT_AUTHOR]\n  },\n  [Entities.ANNOTATION]: {\n    [Actions.ADD]: [Roles.DOCUMENT_MEMBER],\n    [Actions.EDIT]: [Roles.ANNOTATION_AUTHOR],\n    [Actions.READ]: [Roles.DOCUMENT_MEMBER],\n    [Actions.DELETE]: [Roles.ANNOTATION_AUTHOR]\n  }\n}\n\nexport const setPermissions = (setting: UserPermissionSetting = {}): PermissionSetting => {\n  const docPermission = setting.document;\n  const annotPermission = setting.annotation;\n  const updatedSetting = {...defaultSetting};\n  //transform user perm settings to arrays\n  if(docPermission) {\n    if(typeof docPermission === 'string') {\n      //role for all actions\n      Object.keys(defaultSetting.document).forEach(action => updatedSetting.document[action] = [].concat(docPermission));\n    } else {\n      Object.keys(docPermission).forEach(action => updatedSetting.document[action] = [].concat(docPermission[action]));\n    }\n  }\n  if(annotPermission) {\n    if(typeof annotPermission === 'string') {\n      //role for all actions\n      Object.keys(defaultSetting.annotation).forEach(action => {\n        updatedSetting.annotation[action] = [].concat(annotPermission);\n      })\n    } else {\n      Object.keys(annotPermission).forEach(action => updatedSetting.annotation[action] = [].concat(annotPermission[action]));\n    }\n  } \n  return updatedSetting;\n}\n\nconst permissionConstants = {\n  Roles,\n  Actions,\n  Entities\n};\n\nexport default permissionConstants;"},"lineCount":null}},"error":null,"hash":"5a3182ee638ebbd95cb1b5dcc22bc850","cacheData":{"env":{}}}