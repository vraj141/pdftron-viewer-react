{"ast":null,"code":"'use strict';\n\nvar url = require('url');\n\nvar getProxy = require('get-proxy');\n\nvar isurl = require('isurl');\n\nvar tunnelAgent = require('tunnel-agent');\n\nvar urlToOptions = require('url-to-options');\n\nmodule.exports = function (proxy, opts) {\n  proxy = proxy || getProxy();\n  opts = Object.assign({}, opts);\n\n  if (typeof proxy === 'object') {\n    opts = proxy;\n    proxy = getProxy();\n  }\n\n  if (!proxy) {\n    return null;\n  }\n\n  proxy = isurl.lenient(proxy) ? urlToOptions(proxy) : url.parse(proxy);\n  var uriProtocol = opts.protocol === 'https' ? 'https' : 'http';\n  var proxyProtocol = proxy.protocol === 'https:' ? 'Https' : 'Http';\n  var port = proxy.port || (proxyProtocol === 'Https' ? 443 : 80);\n  var method = \"\".concat(uriProtocol, \"Over\").concat(proxyProtocol);\n  delete opts.protocol;\n  return tunnelAgent[method](Object.assign({\n    proxy: {\n      port: port,\n      host: proxy.hostname,\n      proxyAuth: proxy.auth\n    }\n  }, opts));\n};","map":null,"metadata":{},"sourceType":"script"}